<script>
    async function sendEmail(day, status) {
        try {
            const response = await fetch("/send_email", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    date: day,
                    status: status || "特になし"
                })
            });
            const result = await response.json();
            if (response.ok) {
                alert("メールが送信されました！");
            } else {
                alert(`エラーが発生しました: ${result.error}`);
            }
        } catch (error) {
            alert(`エラーが発生しました: ${error}`);
        }
    }
</script>

<td class="today">
    <div>{{ day }}</div>
    {% if status %}
        <div class="status">{{ status }}</div>
    {% endif %}
    <!-- 本日だけ「連絡する」ボタンを表示 -->
    <button 
        class="contact-btn" 
        onclick="sendEmail('{{ year }}年{{ month }}月{{ day }}日', '{{ status }}')">
        連絡する
    </button>
</td>
